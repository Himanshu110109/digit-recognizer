<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Digit Recognizer</title>
  <style>
   @keyframes fadeSlide {
  0% { opacity:0; transform: translateY(10px); }
  20% { opacity:1; transform: translateY(0); }
  80% { opacity:1; transform: translateY(0); }
  100% { opacity:0; transform: translateY(-10px); }
}

.joke { animation: fadeSlide 1s ease-in-out; }

body {
  background:#111;
  color:cyan;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  height:100vh;
  font-family:sans-serif;
}

canvas {
  border:2px solid cyan;
  border-radius:12px;
  cursor:crosshair;
  background:white;
}

button {
  margin:10px;
  padding:10px 20px;
  font-size:16px;
  border-radius:10px;
  border:none;
  cursor:pointer;
}

#predict { background:#16a34a; color:white; }
#clear { background:#dc2626; color:white; }

@media (max-width: 600px) {
  canvas {
    width: 90vw;
    height: 90vw;
  }

  button {
    font-size: 14px;
    padding: 8px 16px;
  }

  h2 {
    font-size: 1.2rem;
  }
}
  </style>
</head>
<body>
  <h2>Draw a digit</h2>
  <canvas id="canvas" width="280" height="280"></canvas>
  <div>
    <button id="predict">Predict</button>
    <button id="clear">Clear</button>
  </div>
  <h3 id="result"></h3>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
ctx.fillStyle = "black";
ctx.fillRect(0,0,280,280);

let drawing = false;

canvas.addEventListener("mousedown", ()=> drawing=true);
canvas.addEventListener("mouseup", ()=> drawing=false);
canvas.addEventListener("mouseleave", ()=> drawing=false);

canvas.addEventListener("mousemove", e => {
  if(!drawing) return;
  ctx.fillStyle = "cyan";
  ctx.beginPath();
  ctx.arc(e.offsetX, e.offsetY, 10, 0, Math.PI*2);
  ctx.fill();
});

canvas.addEventListener("touchstart", e => { drawing=true; e.preventDefault(); });
canvas.addEventListener("touchend", ()=> drawing=false);
canvas.addEventListener("touchmove", e => {
  if(!drawing) return;
  const rect = canvas.getBoundingClientRect();
  const t = e.touches[0];
  const x = t.clientX - rect.left;
  const y = t.clientY - rect.top;
  ctx.fillStyle = "cyan";
  ctx.beginPath();
  ctx.arc(x,y,10,0,Math.PI*2);
  ctx.fill();
  e.preventDefault();
});

 document.getElementById("clear").onclick = ()=>{
   ctx.fillStyle = "black";
   ctx.fillRect(0,0,280,280);
   document.getElementById("result").innerText="";
 };

 document.getElementById("predict").onclick = async ()=>{
   const resultEl = document.getElementById("result");
   const jokes = [
     "Asking Elon chacha ðŸš€...",
     "Connecting to aliens ðŸ‘½...",
     "Waking up the neural hamsters ðŸ¹...",
     "Consulting the matrix ðŸ’Š...",
     "Calling NASA hotline ðŸ“¡..."
   ];

   let i = 0;
   resultEl.innerText = jokes[i]; resultEl.className = "joke";
   const interval = setInterval(()=>{
     i++;
     if(i < jokes.length) resultEl.innerText = jokes[i];
   }, 1000);

   const data = canvas.toDataURL("image/png");

   const res = await fetch("http://10.20.105.127:5000/predict",{
     method:"POST",
     headers:{"Content-Type":"application/json"},
     body: JSON.stringify({image:data})
   });

   const out = await res.json();

   setTimeout(()=>{
     clearInterval(interval);
     resultEl.innerText = "Prediction: " + out.digit;
   }, 5000);
 };
</script>
</body>
</html>